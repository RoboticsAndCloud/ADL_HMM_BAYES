
rank =  [('Leave_Home', '1', '2009-12-11 08:47:19'), ('Leave_Home', '1', '2009-12-11 08:47:24'), ('Leave_Home', '1', '2009-12-11 08:47:26'), ('Leave_Home', '1', '2009-12-11 08:47:29'), ('Leave_Home', '1', '2009-12-11 08:47:33'), ('Leave_Home', '1', '2009-12-11 08:47:38'), ('Guest_Bathroom', '1', '2009-12-11 08:47:48'), ('Read', '1', '2009-12-11 08:48:01'), ('Read', '1', '2009-12-11 08:48:03'), ('Read', '1', '2009-12-11 08:48:05'), ('Read', '1', '2009-12-11 08:48:10'), ('Read', '1', '2009-12-11 08:48:12'), ('Read', '1', '2009-12-11 08:48:15'), ('Read', '1', '2009-12-11 08:48:17'), ('Read', '1', '2009-12-11 08:48:19'), ('Read', '1', '2009-12-11 08:48:22'), ('Read', '1', '2009-12-11 08:48:24'), ('Read', '1', '2009-12-11 08:48:28'), ('Read', '1', '2009-12-11 08:48:31'), ('Read', '1', '2009-12-11 08:48:33'), ('Read', '1', '2009-12-11 08:48:35'), ('Read', '1', '2009-12-11 08:48:38'), ('Read', '1', '2009-12-11 08:48:40'), ('Read', '1', '2009-12-11 08:48:42'), ('Read', '1', '2009-12-11 08:48:45'), ('Read', '1', '2009-12-11 08:48:47'), ('Read', '1', '2009-12-11 08:48:49'), ('Read', '1', '2009-12-11 08:48:51'), ('Read', '1', '2009-12-11 08:48:54'), ('Read', '1', '2009-12-11 08:48:56'), ('Read', '1', '2009-12-11 08:48:58'), ('Read', '1', '2009-12-11 08:49:01'), ('Read', '1', '2009-12-11 08:49:03'), ('Read', '1', '2009-12-11 08:49:05'), ('Read', '1', '2009-12-11 08:49:08'), ('Read', '1', '2009-12-11 08:49:10'), ('Read', '1', '2009-12-11 08:49:12'), ('Read', '1', '2009-12-11 08:49:14'), ('Read', '1', '2009-12-11 08:49:17'), ('Read', '1', '2009-12-11 08:49:19'), ('Read', '1', '2009-12-11 08:49:21'), ('Read', '1', '2009-12-11 08:49:24'), ('Read', '1', '2009-12-11 08:49:26'), ('Read', '1', '2009-12-11 08:49:28'), ('Read', '1', '2009-12-11 08:49:31'), ('Read', '1', '2009-12-11 08:49:33'), ('Read', '1', '2009-12-11 08:49:35'), ('Read', '1', '2009-12-11 08:49:37'), ('Read', '1', '2009-12-11 08:49:40'), ('Read', '1', '2009-12-11 08:49:44'), ('Read', '1', '2009-12-11 08:49:47'), ('Read', '1', '2009-12-11 08:49:49'), ('Guest_Bathroom', '1', '2009-12-11 08:50:42'), ('Guest_Bathroom', '1', '2009-12-11 08:50:45'), ('Guest_Bathroom', '1', '2009-12-11 08:50:47'), ('Watch_TV', '1', '2009-12-11 08:50:59'), ('Read', '1', '2009-12-11 08:51:06'), ('Read', '1', '2009-12-11 08:51:08'), ('Read', '1', '2009-12-11 08:51:10'), ('Read', '1', '2009-12-11 08:51:15'), ('Read', '1', '2009-12-11 08:51:19'), ('Read', '1', '2009-12-11 08:51:24'), ('Read', '1', '2009-12-11 08:51:26'), ('Read', '1', '2009-12-11 08:51:29'), ('Read', '1', '2009-12-11 08:51:31'), ('Read', '1', '2009-12-11 08:51:33'), ('Read', '1', '2009-12-11 08:51:35'), ('Read', '1', '2009-12-11 08:51:38'), ('Read', '1', '2009-12-11 08:51:40'), ('Read', '1', '2009-12-11 08:51:45'), ('Read', '1', '2009-12-11 08:51:47'), ('Read', '1', '2009-12-11 08:51:49'), ('Read', '1', '2009-12-11 08:51:52'), ('Read', '1', '2009-12-11 08:51:54'), ('Read', '1', '2009-12-11 08:51:56'), ('Read', '1', '2009-12-11 08:51:58'), ('Read', '1', '2009-12-11 08:52:01'), ('Read', '1', '2009-12-11 08:52:03'), ('Read', '1', '2009-12-11 08:52:05'), ('Read', '1', '2009-12-11 08:52:08'), ('Read', '1', '2009-12-11 08:52:12'), ('Read', '1', '2009-12-11 08:52:17'), ('Read', '1', '2009-12-11 08:52:21'), ('Read', '1', '2009-12-11 08:52:26'), ('Read', '1', '2009-12-11 08:52:28'), ('Read', '1', '2009-12-11 08:52:31'), ('Read', '1', '2009-12-11 08:52:33'), ('Read', '1', '2009-12-11 08:52:35'), ('Read', '1', '2009-12-11 08:52:40'), ('Kitchen_Activity', '1', '2009-12-11 08:52:47'), ('Guest_Bathroom', '1', '2009-12-11 08:53:26'), ('Guest_Bathroom', '1', '2009-12-11 08:53:29'), ('Guest_Bathroom', '1', '2009-12-11 08:53:38'), ('Guest_Bathroom', '1', '2009-12-11 08:53:40'), ('Guest_Bathroom', '1', '2009-12-11 08:53:42'), ('Guest_Bathroom', '1', '2009-12-11 08:53:47'), ('Guest_Bathroom', '1', '2009-12-11 08:53:49'), ('Guest_Bathroom', '1', '2009-12-11 08:53:52'), ('Guest_Bathroom', '1', '2009-12-11 08:53:56'), ('Leave_Home', '1', '2009-12-11 08:54:03'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:54:20'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:54:22'), ('Master_Bathroom', '1', '2009-12-11 08:54:33'), ('Read', '1', '2009-12-11 08:54:40'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:55:15'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:55:18'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:55:20'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:55:25'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:55:27'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:55:32'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:55:34'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:55:36'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:55:39'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:55:41'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:55:43'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:55:45'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:55:50'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:55:55'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:55:57'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:55:59'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:56:02'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:56:04'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:56:06'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:56:08'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:56:11'), ('Master_Bedroom_Activity', '1', '2009-12-11 08:56:13'), ('Read', '1', '2009-12-11 08:56:22'), ('Read', '1', '2009-12-11 08:56:26'), ('Read', '1', '2009-12-11 08:56:28'), ('Read', '1', '2009-12-11 08:56:30'), ('Read', '1', '2009-12-11 08:56:35'), ('Read', '1', '2009-12-11 08:56:39'), ('Read', '1', '2009-12-11 08:56:42'), ('Read', '1', '2009-12-11 08:56:44'), ('Read', '1', '2009-12-11 08:56:46'), ('Read', '1', '2009-12-11 08:56:49'), ('Read', '1', '2009-12-11 08:56:51'), ('Read', '1', '2009-12-11 08:56:53'), ('Read', '1', '2009-12-11 08:56:55'), ('Read', '1', '2009-12-11 08:56:58'), ('Read', '1', '2009-12-11 08:57:02'), ('Read', '1', '2009-12-11 08:57:07'), ('Read', '1', '2009-12-11 08:57:09'), ('Read', '1', '2009-12-11 08:57:12'), ('Read', '1', '2009-12-11 08:57:14'), ('Read', '1', '2009-12-11 08:57:16'), ('Read', '1', '2009-12-11 08:57:18'), ('Read', '1', '2009-12-11 08:57:21'), ('Read', '1', '2009-12-11 08:57:23'), ('Read', '1', '2009-12-11 08:57:25'), ('Read', '1', '2009-12-11 08:57:30'), ('Read', '1', '2009-12-11 08:57:32'), ('Read', '1', '2009-12-11 08:57:35'), ('Read', '1', '2009-12-11 08:57:37'), ('Read', '1', '2009-12-11 08:57:39'), ('Read', '1', '2009-12-11 08:57:41'), ('Read', '1', '2009-12-11 08:57:44'), ('Read', '1', '2009-12-11 08:57:48'), ('Read', '1', '2009-12-11 08:57:55'), ('Read', '1', '2009-12-11 08:57:58'), ('Read', '1', '2009-12-11 08:58:02'), ('Read', '1', '2009-12-11 08:58:04'), ('Read', '1', '2009-12-11 08:58:07'), ('Read', '1', '2009-12-11 08:58:09'), ('Read', '1', '2009-12-11 08:58:14'), ('Read', '1', '2009-12-11 08:58:16'), ('Read', '1', '2009-12-11 08:58:18'), ('Read', '1', '2009-12-11 08:58:21'), ('Read', '1', '2009-12-11 08:58:23'), ('Read', '1', '2009-12-11 08:58:25'), ('Read', '1', '2009-12-11 08:58:27'), ('Read', '1', '2009-12-11 08:58:30'), ('Read', '1', '2009-12-11 08:58:32'), ('Read', '1', '2009-12-11 08:58:34'), ('Read', '1', '2009-12-11 08:58:39'), ('Read', '1', '2009-12-11 08:58:41'), ('Read', '1', '2009-12-11 08:58:44'), ('Read', '1', '2009-12-11 08:58:46'), ('Read', '1', '2009-12-11 08:58:48'), ('Read', '1', '2009-12-11 08:58:50'), ('Read', '1', '2009-12-11 08:58:53'), ('Read', '1', '2009-12-11 08:58:57'), ('Read', '1', '2009-12-11 08:59:00'), ('Read', '1', '2009-12-11 08:59:02'), ('Read', '1', '2009-12-11 08:59:04'), ('Read', '1', '2009-12-11 08:59:07'), ('Read', '1', '2009-12-11 08:59:09'), ('Guest_Bathroom', '1', '2009-12-11 08:59:16'), ('Read', '1', '2009-12-11 08:59:55'), ('Read', '1', '2009-12-11 09:00:09'), ('Read', '1', '2009-12-11 09:00:11'), ('Read', '1', '2009-12-11 09:00:16'), ('Read', '1', '2009-12-11 09:00:18'), ('Read', '1', '2009-12-11 09:00:23'), ('Read', '1', '2009-12-11 09:00:25'), ('Read', '1', '2009-12-11 09:00:28'), ('Read', '1', '2009-12-11 09:00:30'), ('Read', '1', '2009-12-11 09:00:32'), ('Read', '1', '2009-12-11 09:00:34'), ('Read', '1', '2009-12-11 09:00:37'), ('Read', '1', '2009-12-11 09:00:39'), ('Read', '1', '2009-12-11 09:00:41'), ('Read', '1', '2009-12-11 09:00:44'), ('Read', '1', '2009-12-11 09:00:46'), ('Read', '1', '2009-12-11 09:00:48'), ('Read', '1', '2009-12-11 09:00:53'), ('Read', '1', '2009-12-11 09:00:57'), ('Read', '1', '2009-12-11 09:01:00'), ('Read', '1', '2009-12-11 09:01:02'), ('Read', '1', '2009-12-11 09:01:04'), ('Read', '1', '2009-12-11 09:01:07'), ('Read', '1', '2009-12-11 09:01:11'), ('Read', '1', '2009-12-11 09:01:16'), ('Read', '1', '2009-12-11 09:01:18'), ('Read', '1', '2009-12-11 09:01:20'), ('Read', '1', '2009-12-11 09:01:25'), ('Read', '1', '2009-12-11 09:01:30'), ('Read', '1', '2009-12-11 09:01:32'), ('Read', '1', '2009-12-11 09:01:34'), ('Read', '1', '2009-12-11 09:01:37'), ('Read', '1', '2009-12-11 09:01:39'), ('Read', '1', '2009-12-11 09:01:41'), ('Read', '1', '2009-12-11 09:01:43'), ('Read', '1', '2009-12-11 09:01:46'), ('Read', '1', '2009-12-11 09:01:48'), ('Read', '1', '2009-12-11 09:01:50'), ('Read', '1', '2009-12-11 09:01:53'), ('Read', '1', '2009-12-11 09:01:57'), ('Read', '1', '2009-12-11 09:02:00'), ('Read', '1', '2009-12-11 09:02:02'), ('Read', '1', '2009-12-11 09:02:04'), ('Read', '1', '2009-12-11 09:02:06'), ('Read', '1', '2009-12-11 09:02:09'), ('Read', '1', '2009-12-11 09:02:13'), ('Read', '1', '2009-12-11 09:02:16'), ('Read', '1', '2009-12-11 09:02:18'), ('Read', '1', '2009-12-11 09:02:23'), ('Read', '1', '2009-12-11 09:02:25'), ('Read', '1', '2009-12-11 09:02:27'), ('Read', '1', '2009-12-11 09:02:29'), ('Read', '1', '2009-12-11 09:02:32'), ('Read', '1', '2009-12-11 09:02:34'), ('Read', '1', '2009-12-11 09:02:36'), ('Read', '1', '2009-12-11 09:02:41'), ('Read', '1', '2009-12-11 09:02:46'), ('Read', '1', '2009-12-11 09:02:48'), ('Read', '1', '2009-12-11 09:02:50'), ('Read', '1', '2009-12-11 09:02:52'), ('Read', '1', '2009-12-11 09:02:55'), ('Read', '1', '2009-12-11 09:02:57'), ('Read', '1', '2009-12-11 09:02:59'), ('Read', '1', '2009-12-11 09:03:02'), ('Read', '1', '2009-12-11 09:03:04'), ('Guest_Bathroom', '1', '2009-12-11 09:03:15'), ('Guest_Bathroom', '1', '2009-12-11 09:03:35'), ('Guest_Bathroom', '1', '2009-12-11 09:03:49'), ('Read', '1', '2009-12-11 09:03:58'), ('Read', '1', '2009-12-11 09:04:11'), ('Read', '1', '2009-12-11 09:04:21'), ('Read', '1', '2009-12-11 09:04:23'), ('Read', '1', '2009-12-11 09:04:28'), ('Read', '1', '2009-12-11 09:04:30'), ('Read', '1', '2009-12-11 09:04:32'), ('Read', '1', '2009-12-11 09:04:34'), ('Read', '1', '2009-12-11 09:04:37'), ('Read', '1', '2009-12-11 09:04:39'), ('Read', '1', '2009-12-11 09:04:41'), ('Read', '1', '2009-12-11 09:04:44'), ('Read', '1', '2009-12-11 09:04:46'), ('Read', '1', '2009-12-11 09:04:48'), ('Read', '1', '2009-12-11 09:04:53'), ('Read', '1', '2009-12-11 09:04:57'), ('Guest_Bathroom', '1', '2009-12-11 09:05:25'), ('Read', '1', '2009-12-11 09:05:42'), ('Read', '1', '2009-12-11 09:05:44'), ('Read', '1', '2009-12-11 09:05:48'), ('Read', '1', '2009-12-11 09:05:51'), ('Read', '1', '2009-12-11 09:05:53'), ('Read', '1', '2009-12-11 09:05:55'), ('Read', '1', '2009-12-11 09:05:58'), ('Read', '1', '2009-12-11 09:06:00'), ('Read', '1', '2009-12-11 09:06:02'), ('Read', '1', '2009-12-11 09:06:05'), ('Read', '1', '2009-12-11 09:06:07'), ('Read', '1', '2009-12-11 09:06:09'), ('Read', '1', '2009-12-11 09:06:11'), ('Read', '1', '2009-12-11 09:06:14'), ('Read', '1', '2009-12-11 09:06:16'), ('Read', '1', '2009-12-11 09:06:18'), ('Read', '1', '2009-12-11 09:06:23'), ('Read', '1', '2009-12-11 09:06:25'), ('Read', '1', '2009-12-11 09:06:30'), ('Read', '1', '2009-12-11 09:06:32'), ('Read', '1', '2009-12-11 09:06:34'), ('Read', '1', '2009-12-11 09:06:37'), ('Read', '1', '2009-12-11 09:06:39'), ('Read', '1', '2009-12-11 09:06:41'), ('Read', '1', '2009-12-11 09:06:44'), ('Read', '1', '2009-12-11 09:06:46'), ('Read', '1', '2009-12-11 09:06:48'), ('Read', '1', '2009-12-11 09:06:51'), ('Read', '1', '2009-12-11 09:06:53'), ('Read', '1', '2009-12-11 09:06:55'), ('Read', '1', '2009-12-11 09:06:57'), ('Read', '1', '2009-12-11 09:07:02'), ('Read', '1', '2009-12-11 09:07:04'), ('Guest_Bathroom', '1', '2009-12-11 09:07:11'), ('Guest_Bathroom', '1', '2009-12-11 09:08:07'), ('Guest_Bathroom', '1', '2009-12-11 09:08:10'), ('Guest_Bathroom', '1', '2009-12-11 09:08:12'), ('Guest_Bathroom', '1', '2009-12-11 09:08:17'), ('Read', '1', '2009-12-11 09:08:33'), ('Read', '1', '2009-12-11 09:08:46'), ('Guest_Bathroom', '1', '2009-12-11 09:09:09'), ('Guest_Bathroom', '1', '2009-12-11 09:09:12'), ('Guest_Bathroom', '1', '2009-12-11 09:09:14'), ('Guest_Bathroom', '1', '2009-12-11 09:09:19'), ('Guest_Bathroom', '1', '2009-12-11 09:09:21'), ('Guest_Bathroom', '1', '2009-12-11 09:09:24'), ('Guest_Bathroom', '1', '2009-12-11 09:09:28'), ('Guest_Bathroom', '1', '2009-12-11 09:09:31'), ('Guest_Bathroom', '1', '2009-12-11 09:09:33'), ('Guest_Bathroom', '1', '2009-12-11 09:09:35'), ('Guest_Bathroom', '1', '2009-12-11 09:09:40'), ('Guest_Bathroom', '1', '2009-12-11 09:09:42'), ('Guest_Bathroom', '1', '2009-12-11 09:09:47'), ('Watch_TV', '1', '2009-12-11 09:09:51'), ('Read', '1', '2009-12-11 09:09:58'), ('Watch_TV', '1', '2009-12-11 09:10:00'), ('Read', '1', '2009-12-11 09:10:10'), ('Read', '1', '2009-12-11 09:10:12'), ('Read', '1', '2009-12-11 09:10:17'), ('Read', '1', '2009-12-11 09:10:22'), ('Read', '1', '2009-12-11 09:10:24'), ('Read', '1', '2009-12-11 09:10:26'), ('Read', '1', '2009-12-11 09:10:28'), ('Read', '1', '2009-12-11 09:10:31'), ('Read', '1', '2009-12-11 09:10:33'), ('Read', '1', '2009-12-11 09:10:35'), ('Read', '1', '2009-12-11 09:10:40'), ('Read', '1', '2009-12-11 09:10:45'), ('Guest_Bathroom', '1', '2009-12-11 09:10:49'), ('Guest_Bathroom', '1', '2009-12-11 09:10:59'), ('Guest_Bathroom', '1', '2009-12-11 09:11:06'), ('Guest_Bathroom', '1', '2009-12-11 09:11:11'), ('Leave_Home', '1', '2009-12-11 09:11:31'), ('Guest_Bathroom', '1', '2009-12-11 09:11:38'), ('Guest_Bathroom', '1', '2009-12-11 09:11:45'), ('Guest_Bathroom', '1', '2009-12-11 09:11:47'), ('Guest_Bathroom', '1', '2009-12-11 09:11:52'), ('Guest_Bathroom', '1', '2009-12-11 09:11:56'), ('Guest_Bathroom', '1', '2009-12-11 09:11:59'), ('Guest_Bathroom', '1', '2009-12-11 09:12:01'), ('Read', '1', '2009-12-11 09:12:38'), ('Read', '1', '2009-12-11 09:12:44')]

cnt = 0

# read: 11465(2009-12-11 15:30:51),  5895, 2009-12-11 16:05:47
# kitchen:12510(16:07:12), end 5975, 16:10:50
# Guest_Bathroom,  12624(2009-12-11 16:11:22)  end, 12641, 2009-12-11 16:12:01
# rank_set = set()
# for i in range(len(rank1)):
#     tmp = rank1[i]
#     rank_set.add(tmp[0])


#     # if tmp[0] == 'Read' and (tmp[2].find('15:30') != -1):
#     #     print('Read index:', i)
#     #     print(tmp)
#     # if tmp[0] == 'Kitchen_Activity' and (tmp[2].find('2009-12-11 16:0') != -1):
#     #    print('Kitchen index:', i)
#     #    print(tmp)

#     if tmp[0] == 'Guest_Bathroom' and (tmp[2].find('2009-12-11 16:1') != -1):
#         print('Guest index:', i)
#         print(tmp)

# print(rank_set)


# exit(0)

# start = 11450
# end = 12700

# i = start
# res_dict ={}

# rank_set = set()
# # seti = 0
# # setend = len(rank1)
# seti = start
# setend = end
# while seti < setend:
#     tmp = rank1[seti]
#     rank_set.add(tmp[0])
    
#     tmp = rank2[seti]
#     rank_set.add(tmp[0])
    
#     tmp = rank3[seti]
#     rank_set.add(tmp[0])

#     seti = seti +1

# # print(len(rank1))

# print(rank_set)
# # exit(0)

# for act in rank_set:
#     res_dict[act] = 0


# # output = ['Read', 'Kitchen_Activity', 'Watch_TV', 'Master_Bathroom', 'Guest_Bathroom', 'Bed_to_Toilet', 'Eve_Meds', 'Master_Bedroom_Activity', 'Desk_Activity', 'Chores', 'Morning_Meds', 'Leave_Home', 'Meditate']

# #print('time', '\t', 'rank1', '\t', 'rank2', '\t', 'rank3')

# # print('time', '\t',output[0], '\t',output[1],'\t',output[2],'\t',output[3],'\t',output[4],'\t',output[5],'\t',output[6],'\t',output[7],'\t',output[8],'\t',output[9],'\t',output[10],'\t',output[11],'\t',output[12])

# output = ['Eve_Meds', 'Bed_to_Toilet', 'Master_Bathroom', 'Desk_Activity', 'Morning_Meds', 'Read', 'Leave_Home', 'Watch_TV', 'Chores', 'Guest_Bathroom', 'Meditate', 'Kitchen_Activity']
# print('time', '\t',output[0], '\t',output[1],'\t',output[2],'\t',output[3],'\t',output[4],'\t',output[5],'\t',output[6],'\t',output[7],'\t',output[8],'\t',output[9],'\t',output[10],'\t',output[11],'\t')


# cnt = 0
# i = start
# while i <= end:
#     # print(rank1[i][0], rank2[i][0], rank3[i][0])

#     # print(rank1[i][1], '\t', rank2[i][1], '\t', rank3[i][1])
#     p_rank1 = rank1_res_prob_norm[i]
#     p_rank2 = (1-p_rank1) * (rank2[i][1] + 1e-200)/(rank2[i][1]+ 1e-200+rank3[i][1]+ 1e-200)
#     p_rank3 = (1-p_rank1) * (rank3[i][1] + 1e-200)/(rank2[i][1]+ 1e-200+rank3[i][1]+ 1e-200)
#     # print(rank1[i][2], '\t', p_rank1, '\t', p_rank2, '\t', p_rank3)

#     p = 0
#     for act in rank_set:
#         if rank1[i][0] == act:
#             p = p_rank1
#         elif rank2[i][0] == act:
#             p = p_rank2
#         elif rank3[i][0] == act:
#             p = p_rank3
#         else:
#             p = 0

#         res_dict[act] = p

#     if cnt % 3 == 0:
#         print(rank1[i][2], '\t',res_dict[output[0]], '\t',res_dict[output[1]],'\t',res_dict[output[2]],'\t',res_dict[output[3]],'\t',res_dict[output[4]],'\t',res_dict[output[5]],'\t',res_dict[output[6]],'\t',res_dict[output[7]],'\t',res_dict[output[8]],'\t',res_dict[output[9]],'\t',res_dict[output[10]],'\t',res_dict[output[11]] )

#     cnt = cnt + 1

#     # print(rank1[i][2], '\t', rank1_res_prob_norm[i], '\t', rank2_res_prob_norm[i], '\t', rank3_res_prob_norm[i])

#     i = i + 1

# print('rank3:', len(rank3))

# print('==========================')
# print('time', '\t', 'act index')
# i = start
# cnt = 0
# import constants
# while i <= end:
#     if cnt % 3 == 0:
#         print(rank1[i][2], '\t', constants.ACTIVITY_DICT_INDEX[rank1[i][0]])

#     i += 1
#     cnt += 1


# print('===============================================')

# exit(0)

"""
rank_set = set()
seti = 0
setend = len(rank1)
res_dict ={}

while seti < setend:
    tmp = rank1[seti]
    rank_set.add(tmp[0])
    
    tmp = rank2[seti]
    rank_set.add(tmp[0])
    
    tmp = rank3[seti]
    rank_set.add(tmp[0])

    seti = seti +1

# print(len(rank1))

print(rank_set)
# exit(0)

for act in rank_set:
    res_dict[act] = 0

for act in rank_set:
    res_dict[act] = 0
"""
# output = ['Read', 'Kitchen_Activity', 'Watch_TV', 'Master_Bathroom', 'Guest_Bathroom', 'Bed_to_Toilet', 'Eve_Meds', 'Master_Bedroom_Activity', 'Desk_Activity', 'Chores', 'Morning_Meds', 'Leave_Home', 'Meditate']

# #print('time', '\t', 'rank1', '\t', 'rank2', '\t', 'rank3')

# print('time', '\t',output[0], '\t',output[1],'\t',output[2],'\t',output[3],'\t',output[4],'\t',output[5],'\t',output[6],'\t',output[7],'\t',output[8],'\t',output[9],'\t',output[10],'\t',output[11],'\t',output[12])


# cnt = 0
# i = start
# while i <= end:
#     # print(rank1[i][0], rank2[i][0], rank3[i][0])

#     # print(rank1[i][1], '\t', rank2[i][1], '\t', rank3[i][1])
#     p_rank1 = rank1_res_prob_norm[i]
#     p_rank2 = (1-p_rank1) * (rank2[i][1] + 1e-200)/(rank2[i][1]+ 1e-200+rank3[i][1]+ 1e-200)
#     p_rank3 = (1-p_rank1) * (rank3[i][1] + 1e-200)/(rank2[i][1]+ 1e-200+rank3[i][1]+ 1e-200)
#     # print(rank1[i][2], '\t', p_rank1, '\t', p_rank2, '\t', p_rank3)

#     p = 0
#     for act in rank_set:
#         if rank1[i][0] == act:
#             p = 1
#         else:
#             p = 0

#         res_dict[act] = p

#     if cnt % 3 == 0:
#         print(rank1[i][2], '\t',res_dict[output[0]], '\t',res_dict[output[1]],'\t',res_dict[output[2]],'\t',res_dict[output[3]],'\t',res_dict[output[4]],'\t',res_dict[output[5]],'\t',res_dict[output[6]],'\t',res_dict[output[7]],'\t',res_dict[output[8]],'\t',res_dict[output[9]],'\t',res_dict[output[10]],'\t',res_dict[output[11]],'\t',res_dict[output[12]] )

#     cnt = cnt + 1
#     i = i + 1


print('==========================All activities')
print('time', '\t', 'act index')
i = 0
cnt = 0
import constants
end = len(rank1)
while i < end:
    if cnt % 3 == 0:
        #print(rank1[i])
        if rank1[i][0] == '':
            print(rank1[i][2], '\t', -1)
        else:
            print(rank1[i][2], '\t', constants.ACTIVITY_DICT_INDEX[rank1[i][0]])

    i += 1
    cnt += 1


import tools_ascc
from datetime import datetime

DATE_HOUR_TIME_FORMAT = '%Y-%m-%d %H:%M:%S'
HOUR_TIME_FORMAT = "%H:%M:%S"

def get_activity_duration_for_day_output(event_list):

    day_time_str = '2009-12-11'
    day_begin ='08:45:00'


    activity_date_dict, activity_begin_dict, activity_end_dict, \
        activity_begin_list, activity_end_list  = tools_ascc.get_activity_date(day_time_str)

    day_begin, day_end = tools_ascc.get_day_begin_end(activity_date_dict,
                                            activity_begin_dict, activity_end_dict)

    hit_activity_check_times = 0

    print("=====================================")
    print("Date:", day_time_str)
    print("activity_begin_dict", len(activity_begin_dict))
    print("activity_end_dict", len(activity_end_dict))

    motion_activity_cnt = 0
    import collections
    output_dict = {}
    output_dict2 = {}  # timestamp is at the beginning

    output_miss_event_dict = {}

    last_hit_time_list = []
    last_miss_time_set = set()
    print("Activity", "\t", "Start", "\t", "End", "\t", "Duration")

    for key in activity_begin_dict.keys():
        time_list_begin = activity_begin_dict[key]
        time_list_end = activity_end_dict[key]
        if key == 'Sleep':
            time_list_begin = time_list_begin[:-1]
            time_list_end = time_list_end[1:]
        for t_i in range(len(time_list_begin)):
            a_begin = datetime.strptime(time_list_begin[t_i], DATE_HOUR_TIME_FORMAT)
            try:
                a_end = datetime.strptime(time_list_end[t_i], DATE_HOUR_TIME_FORMAT)
            except:
                print("End list not good", len(time_list_begin), len(time_list_end))
                break

            duration = (a_end - a_begin).seconds * 1.0 /60


            # each day start after getting up (sleep end), ignore the activies before the time of 'sleep end'
            tmp_a_end = datetime.strptime(time_list_begin[t_i].split()[1], HOUR_TIME_FORMAT)
            if tmp_a_end < day_begin:
                print("A end < day begin, ignore:", a_end, day_begin)
                break

            motion_activity_cnt = motion_activity_cnt + 1

            if duration > 0:
                tmp_str = key + "\t" + time_list_begin[t_i] + "\t" + time_list_end[t_i] + "\t" + str(duration)
                tmp_str2 = time_list_begin[t_i] + "\t" + time_list_end[t_i] + "\t" + key + "\t" + str(duration)

                output_dict[time_list_begin[t_i]] = tmp_str
                output_dict2[time_list_begin[t_i]] = tmp_str2


                for item in event_list:
                    # print("kkkkk:",k_time, "  vvvvv",v)
                    k = item[0]
                    k_time = item[2]

                    hit_time = datetime.strptime(k_time, DATE_HOUR_TIME_FORMAT)
                    

                    if k == key:
                        if hit_time >= a_begin and hit_time <= a_end:
                            hit_activity_check_times = hit_activity_check_times + 1
                            ## Note: in dict, the time is out off order
                            last_hit_time_list.append(hit_time)
                            # print("#####:hit time:", hit_time, key)
                            break
                    else:

                        if hit_time > a_end:                        
                            output_miss_event_dict[time_list_begin[t_i]] = tmp_str
                            last_miss_time_set.add(a_begin)



    sd = sorted(output_dict.items())
    sd2 = sorted(output_dict2.items())

    for k,v in sd:
        print(v)
    
    print("---------------------------------------------------------")
    for k,v in sd2:
        print(v)
    
    total_activity_cnt = tools_ascc.get_activity_count_by_date(day_time_str)

    print("##########################################")
    print("Total_activity_cnt", total_activity_cnt)
    print("Hit_activity_check_times:",  hit_activity_check_times)
    print("Miss_activity_check_times:",  len(output_miss_event_dict))
    print("Miss activity list:")
    real_total_act_cnt = hit_activity_check_times + len(output_miss_event_dict)
    miss_activity_ratio =  len(output_miss_event_dict) * 1.0 / (real_total_act_cnt)
    print("Miss activity ratio:", miss_activity_ratio)

    activity_detection_ratio = hit_activity_check_times * 1.0 /total_activity_cnt
    print("Activity detection ratio:", activity_detection_ratio)

    sd = sorted(output_miss_event_dict.items())
    for k,v in sd:
        print(v)

    
    return miss_activity_ratio

get_activity_duration_for_day_output(rank1)

